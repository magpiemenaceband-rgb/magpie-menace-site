<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Magpie Menace</title>
  <meta name="description" content="Magpie Menace — music, videos, merch, news, and the Magpie Militia fan club." />
  <meta name="description" content="Magpie Menace — music, videos, merch, news, and the Magpie Militia fan club." />

  <style>
    :root{
      /* light grey with a subtle reddish tint */
      --bg:#f3eeee;
      --panel: rgba(255,255,255,.72);
      --panel-2: rgba(255,255,255,.86);
      --ink:#1e1e22;
      --muted:#5a5a66;
      --accent:#b43a3a;
      --stroke: rgba(20,20,26,.10);
      --shadow: 0 18px 60px rgba(20,20,26,.12);
      --shadow-soft: 0 10px 30px rgba(20,20,26,.10);
      --radius: 22px;
      --radius-sm: 16px;
	  --orbit-tile-w: 150px;
	  --orbit-tile-h: 125px;
      /* Cursor images (replace with your own PNGs, ideally 64–128px)
         Provide at least magpie.png; the “active” cursor swaps on hover.
      */
      
    }

.orbit-ring{
  position:absolute;
  inset:0;
  pointer-events:none;         /* ring itself doesn’t block */
  z-index:2;
}


    *{ box-sizing:border-box; }
  html,body{
  margin:0;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
  color:var(--ink);
  overflow-x:hidden;
  cursor:none;
  min-height:100%;
}

body{
  /* Your EP-color background */
  background:
    radial-gradient(1200px 800px at 10% 20%, #f4b24f 0%, transparent 55%),
    radial-gradient(1000px 700px at 35% 60%, #c94a32 0%, transparent 60%),
    radial-gradient(900px 700px at 55% 30%, #c0253a 0%, transparent 60%),
    radial-gradient(900px 700px at 70% 70%, #b53f7c 0%, transparent 60%),
    radial-gradient(1000px 800px at 85% 40%, #2a356e 0%, transparent 65%),
    radial-gradient(1200px 900px at 95% 80%, #0f1a3a 0%, transparent 70%),
    linear-gradient(135deg, #f4b24f 0%, #c0253a 40%, #5b2d6f 70%, #0f1a3a 100%);
  background-attachment: fixed;
  background-repeat: no-repeat;
  background-size: cover;


  /* Drift */
  animation: bgDrift 40s ease-in-out infinite alternate;
}

@keyframes bgDrift{
  0%   { background-position: 0% 0%, 0% 0%, 0% 0%, 0% 0%; }
  100% { background-position: 2% 2%, -2% 3%, 3% -2%, 0% 0%; }
}
    body, a, button, img, .tile, .pill, .btn { cursor: none !important; }

    /* Slightly interactive “sparkle” noise layer */
    .grain{
      pointer-events:none;
      position:fixed;
      inset:0;
      opacity:.22;
      mix-blend-mode:multiply;
      background-image:
        radial-gradient(circle at 15% 20%, rgba(255,255,255,.55) 0 1px, transparent 2px),
        radial-gradient(circle at 60% 30%, rgba(255,255,255,.35) 0 1px, transparent 2px),
        radial-gradient(circle at 80% 70%, rgba(255,255,255,.35) 0 1px, transparent 2px),
        radial-gradient(circle at 35% 80%, rgba(255,255,255,.35) 0 1px, transparent 2px);
      background-size: 280px 280px;
      animation: drift 14s linear infinite;
    }
    @keyframes drift{ from{ transform:translate3d(0,0,0);} to{ transform:translate3d(-140px,-140px,0);} }

    header{
      position:sticky;
      top:0;
      z-index:20;
      backdrop-filter: blur(14px);
      background: rgba(243,238,238,.70);
      border-bottom:1px solid var(--stroke);
    }

    .wrap{ max-width:1100px; margin:0 auto; padding:18px 18px; }

    /* Top header layout */
.topbar{
  display:grid;
  grid-template-columns: auto 1fr auto;
  align-items:center;
}

/* Brand container */
.brand{
  display:flex;
  align-items:center;
  gap:18px;
}

	/* Left logo */
.logo-mark{
  height:90px;
}

.logo-mark img{
  height:100%;
  width:auto;
  object-fit:contain;
  display:block;
}

/* CENTER BAND NAME */
.brand-text{
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  text-align:center;
}

/* Larger band name */
.brand-text img{
  height:80px;   /* Increase this for bigger */
  width:auto;
  object-fit:contain;
  display:block;

  /* Subtle glow */
  filter:
    drop-shadow(0 0 8px rgba(255,255,255,.25))
    drop-shadow(0 10px 30px rgba(180,58,58,.25));

  transition: transform .2s ease, filter .2s ease;
}

/* Slight hover life */
.brand-text img:hover{
  transform: scale(1.03);
  filter:
    drop-shadow(0 0 14px rgba(255,255,255,.35))
    drop-shadow(0 16px 40px rgba(180,58,58,.35));
}

.brand-text .tag{
  margin-top:8px;
  font-size:14px;
  letter-spacing:.3px;
  color: rgba(0,0,0,.75);
}

    .logo{
  display:flex;
  align-items:center;
  justify-content:center;

  height:64px;          /* controls header height feel */
}

.logo img{
  height:100%;
  width:auto;
  object-fit:contain;
  display:block;
}

    .brand h1{ margin:0; font-size:18px; line-height:1.1; }
    .brand .tag{ margin:0; color:var(--muted); font-size:12px; }

    .actions{
      display:flex;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
      justify-content:flex-end;
    }

    .pill{
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.72);
      padding:10px 12px;
      border-radius: 999px;
      text-decoration:none;
      color: var(--ink);
      font-weight:650;
      font-size:13px;
      display:inline-flex;
      align-items:center;
      gap:8px;
      box-shadow: 0 10px 22px rgba(20,20,26,.08);
      transition: transform .12s ease, background .12s ease;
    }

    .pill:hover{ transform: translateY(-1px); background: rgba(255,255,255,.88); }
	
	/* Stop pill enhancements */
.stop-pill{
  gap:10px;
}

.stop-pill:not(.live){
  opacity:.85;
}

.stop-pill[aria-disabled="true"]{
  opacity:.7;
}

.stop-pill[aria-disabled="true"] .wave i{
  animation:none !important;
}

.stop-pill{
  cursor: none;
  border: 1px solid var(--stroke);
  display: inline-flex;
  width: fit-content;
  pointer-events: auto;
}

.stop-pill *{
  pointer-events: none; /* makes the whole pill clickable as one target */
}

.stop-label{
  display:inline-block;
  transition: opacity 160ms ease;
}

.stop-label.fading{
  opacity:.35;
}

/* Waveform icon */
.wave{
  display:inline-flex;
  align-items:flex-end;
  gap:2px;
  height:14px;
}

.wave i{
  display:block;
  width:2px;
  height:6px;
  background: rgba(90,90,102,.8);
  border-radius: 2px;
  transform-origin: bottom;
  opacity:.85;
}

.stop-pill.live .wave i{
  background: rgba(180,58,58,.95);
}

/* Animate the bars only when live */
.stop-pill.live .wave i:nth-child(1){ animation: wave 700ms ease-in-out infinite; }
.stop-pill.live .wave i:nth-child(2){ animation: wave 520ms ease-in-out infinite; }
.stop-pill.live .wave i:nth-child(3){ animation: wave 610ms ease-in-out infinite; }

@keyframes wave{
  0%,100%{ transform: scaleY(.6); }
  50%{ transform: scaleY(1.6); }
}

/* Pulsing red “Stop” when live */
.stop-pill.live{
  border-color: rgba(180,58,58,.35);
  background: rgba(180,58,58,.10);
  animation: stopPulse 1100ms ease-in-out infinite;
}

@keyframes stopPulse{
  0%,100%{ box-shadow: 0 10px 22px rgba(20,20,26,.08), 0 0 0 0 rgba(180,58,58,.18); }
  50%{ box-shadow: 0 10px 22px rgba(20,20,26,.08), 0 0 0 6px rgba(180,58,58,.10); }
}
    .pill:active{ transform: translateY(0px); }

    main .grid{
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap:18px;
      padding:18px;
      max-width:1100px;
      margin:0 auto;
    }

    @media (max-width: 980px){
      main .grid{ grid-template-columns: 1fr; }
    }

    .panel{
      background: var(--panel);
      border:1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }

    /* “Shiny object” background per section (replace with your images) */
    .panel::before{
      content:"";
      position:absolute;
      inset:-8px;
      opacity:.30;
      background-position: right 12px bottom 12px;
      background-repeat:no-repeat;
      background-size: 220px;
      filter: saturate(1.05) contrast(1.05);
      pointer-events:none;
      transform: rotate(-2deg);
    }

    .panel-inner{ position:relative; padding:18px; }

    .hero{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:14px;
      padding:22px 22px 10px;
    }
	
    .hero h2{ margin:0; font-size:28px; letter-spacing:-.4px; }
    .hero p{ margin:8px 0 0; color:var(--muted); max-width:62ch; }
	.hero-right{
  display:flex;
  flex-direction:column;
  align-items:flex-end;
  gap:10px;
  position:relative;
  z-index:5;
}

.now-playing{
  position:relative;
  display:flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius: 999px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.70);
      box-shadow: 0 10px 22px rgba(20,20,26,.08);
      font-size:12px;
      color: var(--muted);
      white-space:nowrap;
  z-index:1;
}

.stop-pill{
  position:relative;
  z-index:2;
}

button.stop-pill{
  appearance: none;
  border: 1px solid var(--stroke);
  background: rgba(255,255,255,.72);
}

#stopAudio{
  position: relative;
  z-index: 10000; /* higher than anything else on the page */
  pointer-events: auto;
}

#stopAudio *{
  pointer-events: none;
}
    .dot{
      width:8px; height:8px; border-radius:999px;
      background: rgba(180,58,58,.70);
      box-shadow: 0 0 0 5px rgba(180,58,58,.12);
      animation: pulse 1.4s ease-in-out infinite;
    }
    @keyframes pulse{ 0%,100%{ transform:scale(.95); opacity:.7;} 50%{ transform:scale(1.15); opacity:1; } }

    /* Section tiles */
    .tiles{
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap:12px;
      padding: 12px 18px 18px;
    }

    @media (max-width: 520px){
      .tiles{ grid-template-columns: 1fr; }
    }

.tile{
  position:relative;
  border-radius: var(--radius-sm);
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(255,255,255,.06);        
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);

  box-shadow: 0 10px 22px rgba(20,20,26,.10);
  padding:14px 16px;
  overflow:hidden;                          
  transition: transform .14s ease, background .14s ease, border-color .14s ease;
  min-height:92px;
  display:flex;
  flex-direction:column;
  gap:6px;
}

.tile:hover{
  transform: translateY(-2px);
  background: rgba(255,255,255,.16);
  border-color: rgba(255,255,255,.26);
}

    /* Subtle “peck” animation on hover */
    @keyframes peck{
      0%{ transform: translateY(0) rotate(0); }
      30%{ transform: translateY(2px) rotate(-.4deg); }
      55%{ transform: translateY(-1px) rotate(.2deg); }
      100%{ transform: translateY(0) rotate(0); }
    }

    .tile:hover{ animation: peck 220ms ease-out 1; }
    .tile:hover{ transform: translateY(-2px); background: rgba(255,255,255,.80); }
    .tile:hover::before{ opacity:.42; transform: rotate(-2deg) scale(1.01); }
    .tile:focus-visible{ outline: 3px solid rgba(180,58,58,.35); outline-offset: 2px; }

    .tile .kicker{ font-size:12px; color:var(--muted); }
    .tile .title{ font-size:16px; margin:0; font-weight:800; letter-spacing:-.2px; }

    /* Right-side details panel */
    .detail-card{
      background: var(--panel-2);
      border:1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      position:sticky;
      top:86px;
    }
	
	/* Make the two main sections more transparent (glassy) */
.panel,
.detail-card{
  background: rgba(255,255,255,.18) !important;
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
  border: 1px solid rgba(255,255,255,.22);
}

/* Slightly different tint for the right panel if you want */
.detail-card{
  background: rgba(255,255,255,.14) !important;
}

    .detail-head{
      padding:18px;
      border-bottom:1px solid var(--stroke);
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
    }

    .detail-head h3{ margin:0; font-size:18px; }
    .detail-head p{ margin:6px 0 0; color:rgba(255,255,255,.80); font-size:13px; }

    .detail-body{ padding:18px; }
    .detail-body ul{ margin:0; padding:0 0 0 18px; color:rgba(255,255,255,.88); }
    .detail-body li{ margin: 8px 0; }
	
    .cta-row{ display:flex; flex-wrap:wrap; gap:10px; margin-top:14px; }

    .btn{
      border:1px solid rgba(180,58,58,.25);
      background: rgba(180,58,58,.12);
      color: var(--ink);
      padding:10px 12px;
      border-radius: 999px;
      text-decoration:none;
      font-weight:750;
      font-size:13px;
      display:inline-flex;
      align-items:center;
      gap:8px;
      transition: transform .12s ease, background .12s ease;
    }

    .btn:hover{ transform: translateY(-1px); background: rgba(180,58,58,.18); }

    .qr{
      display:flex;
      gap:20px;
      align-items:center;
	  justify-content:center;
      margin-top:16px;
      padding:14px;
      border-radius: 18px;
      border:1px dashed rgba(180,58,58,.35);
      background: rgba(255,255,255,.55);
	  flex-wrap:wrap;
    }

	.qr-codes{
  display:flex;
  gap:14px;
  flex-wrap: wrap;      
  justify-content: center;
  max-width: 100%;
}

.qr-item{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:6px;
}

.qr-item img{
  width:130px;
  height:130px;
  border-radius:14px;
  border:1px solid var(--stroke);
  background:#fff;
}

.qr-label{
  font-size:12px;
  font-weight:700;
  opacity:.8;
}

/* Clickable QR styling */
.qr-item a{
  display:block;
  border-radius:14px;
  transition: transform .18s ease, box-shadow .18s ease;
}

.qr-item img{
  width:130px;
  height:130px;
  border-radius:14px;
  border:1px solid var(--stroke);
  background:#fff;
  transition: transform .18s ease, box-shadow .18s ease, filter .18s ease;
}

/* Subtle glow on hover */
.qr-item a:hover img{
  transform: scale(1.04);
  box-shadow:
    0 0 0 3px rgba(180,58,58,.18),
    0 0 25px rgba(180,58,58,.25),
    0 12px 30px rgba(0,0,0,.18);
  filter: brightness(1.03);
}

    footer{ padding:28px 18px 40px; color: var(--muted); text-align:center; }
    footer a{ color: var(--accent); text-decoration:none; font-weight:700; }

    /* Reduce motion preference */
    @media (prefers-reduced-motion: reduce){
      .grain{ animation:none; }
      .dot{ animation:none; }
      .tile,.pill,.btn{ transition:none; }
      .tile:hover{ animation:none; }
      .mm-cursor{ transition:none; }
      .sparkle{ animation:none; }
    }

    /* Custom cursor */
    .mm-cursor{
      position:fixed;
      left:0; top:0;
      width:56px;
      height:56px;
      transform: translate3d(-9999px,-9999px,0);
      pointer-events:none;
      z-index:9999;
      will-change: transform;
      transition: width 120ms ease, height 120ms ease;
      filter: drop-shadow(0 10px 18px rgba(20,20,26,.18));
    }
    .mm-cursor.big{ width:72px; height:72px; }
    .mm-cursor img{ width:100%; height:100%; display:block; }

   /* Cursor “peck” */
	.mm-cursor.pecking img { animation: cursorImgPeck 220ms ease-out 1; }

@keyframes cursorImgPeck{
  0%{ transform: rotate(0deg) translateY(0) scale(1); }
  35%{ transform: rotate(-6deg) translateY(4px) scale(.99); }
  65%{ transform: rotate(2deg) translateY(-2px) scale(1.01); }
  100%{ transform: rotate(0deg) translateY(0) scale(1); }
}

    /* Sparkles */
    .sparkle{
      position:fixed;
      width:10px; height:10px;
      border-radius:999px;
      background: rgba(255,255,255,.95);
      box-shadow:
        0 0 0 3px rgba(180,58,58,.16),
        0 0 18px rgba(180,58,58,.20);
      pointer-events:none;
      z-index:9998;
      will-change: transform, opacity;
      opacity:0;
      animation: sparklePop 520ms ease-out forwards;
    }
	
	
    @keyframes sparklePop{
      0%{ opacity:0; transform: translate3d(var(--sx), var(--sy), 0) scale(0.6); }
      20%{ opacity:1; }
      100%{ opacity:0; transform: translate3d(calc(var(--sx) + var(--dx)), calc(var(--sy) + var(--dy)), 0) scale(1.0); }
    }
    .sparkle::before,
    .sparkle::after{
      content:"";
      position:absolute;
      inset:0;
      margin:auto;
      width:2px;
      height:12px;
      background: rgba(255,255,255,.9);
      border-radius:2px;
      transform: rotate(45deg);
    }
    .sparkle::after{ transform: rotate(-45deg); }
     
body{
  animation: bgDrift 40s ease-in-out infinite alternate;
}

@keyframes bgDrift{
  0% { background-position: 0% 0%, 0% 0%, 0% 0%, 0% 0%, 0% 0%, 0% 0%, 0% 0%; }
  100% { background-position: 2% 2%, -2% 3%, 3% -2%, -3% 1%, 2% -3%, -1% 2%, 0% 0%; }
}	 

/* LEFT PANEL TEXT = BLACK */
.panel{
  color: #1a1a1a;
}

.panel h2,
.panel p,
.panel .kicker,
.panel .title{
  color: #1a1a1a;
}

/* Make sure hero subtitle is black */
#heroText{
  color: #1a1a1a;
}

/* FOOTER TEXT = BLACK */
footer{
  color: rgba(255,255,255,.92);
}

footer a{
  color: rgba(255,255,255,.92);
}

/* Tile layout */
.tile{
  display:flex;
  flex-direction:column;
  align-items:center;
  text-align:center;
  padding:18px;
  gap:10px;
}

/* Image container */
.tile-img-wrap{
  width:100%;
  display:flex;
  justify-content:center;
  align-items:center;
}

/* The shiny image */
.tile-img{
  max-width:120px;
  height:auto;
  object-fit:contain;
  opacity:.9;
  transition: transform .18s ease;
}

.tile:hover .tile-img{
  transform: scale(1.05);
}

/* Title */
.tile .title{
  font-size:18px;
  font-weight:800;
  margin:0;
}

/* Subtitle / kicker */
.tile .kicker{
  font-size:13px;
  opacity:.75;
}

/* ===== STAGE LAYOUT (replaces orbit) ===== */
.stage{
  width: 100%;
  padding: 18px 18px 34px;
  display: grid;
  gap: 16px;
  align-content: start;
}

/* Top links bar under header */
.top-links{
  width: min(1100px, 96vw);
  margin: 0 auto;
}

/* Horizontal scroll row (mobile friendly) */
.top-links-row{
  display:flex;
  gap:12px;
  padding: 10px 6px 6px;

  /* ✅ no scrolling */
  overflow: visible;
  scroll-snap-type: none;

  /* ✅ wrap to new lines instead of scroll */
  flex-wrap: wrap;
  justify-content: center;
}

html{
  scroll-behavior: smooth;
}


/* Make tiles “album card” sized for a top row */
.orbit-tile{
  position: relative;            /* no absolute positioning anymore */
  transform: none;               /* remove translate */
  pointer-events: auto;
  flex: 0 1 140px;   /* ✅ can shrink a bit */
  width: 140px;      /* ✅ smaller */
  padding: 10px;
  height: auto;
  border-radius: 18px;
  background: rgba(255,255,255,.10);
  border: 1px solid rgba(255,255,255,.22);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  box-shadow: 0 16px 52px rgba(0,0,0,.18);
  overflow: hidden;
  scroll-snap-align: start;
  color: #1a1a1a;        /* force text color */
  -webkit-tap-highlight-color: transparent; /* remove blue flash on tap */
  appearance: none;
  -webkit-appearance: none;
  background-clip: padding-box;
}

/* Give the image more room, text below */
.orbit-tile .tile-img-wrap{
  width: 100%;
  height: 62px;
  display: grid;
  place-items: center;
  margin-bottom: 8px;
}
.orbit-tile .tile-img{
  max-width: 80px;
  max-height: 62px;
  width: auto;
  height: auto;
  object-fit: contain;
  display: block;
  filter: drop-shadow(0 10px 18px rgba(0,0,0,.20));
}

/* Title + kicker stacked */
.orbit-tile .title{
  margin: 0;
  font-weight: 900;
  text-align: center;

  /* Responsive scaling without changing box size */
  font-size: clamp(15px, 1.1vw, 18px);
  line-height: 1.1;
}
.orbit-tile .kicker{
  margin-top: 4px;
  font-size: 11px;
  opacity: .9;
  text-align: center;
  color: #1a1a1a;
}

/* Hover effect */
.orbit-tile:hover{
  transform: translateY(-4px);
  background: rgba(255,255,255,.20);   /* lighter glass */
  border-color: rgba(255,255,255,.38);
  box-shadow: 0 20px 60px rgba(0,0,0,.28);
}

/* Image glow boost */
.orbit-tile:hover .tile-img{
  filter:
    drop-shadow(0 12px 22px rgba(0,0,0,.35))
    drop-shadow(0 0 12px rgba(255,255,255,.25));
  transform: scale(1.06);
}

.orbit-tile{
  transition:
    transform .18s ease,
    background .18s ease,
    border-color .18s ease,
    box-shadow .18s ease;
}

/* Center panel below */
.center-stage{
  width: min(860px, 96vw);
  margin: 0 auto;
  position: relative;
  z-index: 1;
}

/* Optional: tighten the hero row for mobile */
@media (max-width: 720px){
  .center-hero{
    flex-direction: column;
    align-items: stretch;
    gap: 10px;
  }
  .hero-right{
    align-items: flex-start;
  }
}

@media (min-width: 1050px){
  .orbit-tile{ width: 130px; }
}

.center-hero > div:first-child{
  display:none;
}

/* Optional: slightly smaller QRs on phones so 3 fits nicely */
@media (max-width: 520px){
  .qr-item img{
    width:110px;
    height:110px;
  }
}

.link-strip{
  max-width: 1100px;
  margin: 12px auto 0;
  padding: 0 18px;
  display:flex;
  gap:12px;
  align-items:flex-start;
  justify-content:center;
  flex-wrap:wrap;
  position:relative;
  z-index:5; /* stays above background */
}

/* smaller “album card” tiles for the header row */
.link-strip .tile{
  width: 140px;
  min-height: 120px;
  padding: 10px;
  border-radius: 18px;
}

.mm-cursor{
  display:block;
}
.mm-cursor img{
  background: transparent;
}

.status-row{
  width: min(1100px, 96vw);
  margin: 6px auto 14px;
  display:flex;
  justify-content:center;
  align-items:center;
  gap:12px;
  position: relative;
  z-index: 5;
}

/* Make the pills match the header row vibe */
.status-row .now-playing{
  background: rgba(255,255,255,.60);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
}

@media (max-width: 720px){
  .status-row{
    flex-direction: column;
    gap: 8px;
  }
}

/* MOBILE: keep the details panel in normal flow (not sticky) */
@media (max-width: 720px){
  .detail-card{
    position: relative;   /* was sticky */
    top: auto;
    z-index: 1;
  }
  
  .detail-head{ padding: 14px; }
  .detail-body{ padding: 14px; }

  /* optional: a little breathing room */
  .center-stage{
    margin-top: 4px;
  }
}

/* Make sure sticky panel can appear above other positioned rows */
.detail-card{
  z-index: 10;
}

/* Bottom detail card text = white */
/* Make only body content white */
.detail-body li{
  color: #1a1a1a;
}

.detail-card h3,
.detail-card p,
.detail-card li,
.detail-card .qr-label{
  color: #1a1a1a;
}

.qr-text,
.qr-text div{
  color: rgba(255,255,255,.92);
}

/* Keep header text darker */
.detail-head h3,
.detail-head p{
  color: #1a1a1a;
}

.support-note{
  color: rgba(255,255,255,.92);
}

.detail-body iframe{
  border-radius:16px;
  box-shadow: 0 18px 50px rgba(0,0,0,.28);
}


/* Invisible “first click” catcher */
.iframe-guard{
  position: absolute;
  inset: 0;
  border-radius: 16px;
  background: transparent;
  z-index: 5;
  cursor: pointer; /* doesn't matter with your custom cursor, but fine */
}

/* Disable custom cursor on touch devices (phones/tablets) */
@media (any-pointer: coarse), (pointer: coarse), (max-width: 820px){
  .mm-cursor{
    display: none !important;
  }

  html, body,
  a, button, img,
  .tile, .pill, .btn {
    cursor: auto !important;
  }

  /* Undo your global cursor:none on touch */
  html, body{
    cursor: auto !important;
  }
}


.streaming-links{
  margin-top: 14px;
  display:flex;
  flex-wrap: nowrap;       /* keep one row */
  gap:8px;                 /* slightly tighter spacing */
  justify-content:center;
  align-items:center;
}

.stream-btn{
  --glow: rgba(255,255,255,.18);

  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:6px 12px;
  border-radius:999px;
  text-decoration:none;
  font-size:12px;
  font-weight:700;

  border:1px solid rgba(255,255,255,.22);
  background: rgba(255,255,255,.10);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);

  color:#fff;
  white-space:nowrap;      /* prevent label wrapping */
  transition: transform .18s ease, box-shadow .18s ease, background .18s ease, border-color .18s ease;
}

.stream-ico{
  width:16px;
  height:16px;
  display:flex;
  align-items:center;
  justify-content:center;
}

.stream-ico svg{
  width:16px;
  height:16px;
  fill: #fff;
  opacity: .95;
  filter: drop-shadow(0 0 6px var(--glow));
}

.stream-btn:hover{
  transform: translateY(-2px);
  background: rgba(255,255,255,.16);
  border-color: rgba(255,255,255,.32);
  box-shadow:
    0 0 0 3px rgba(255,255,255,.06),
    0 0 18px var(--glow),
    0 12px 30px rgba(0,0,0,.22);
}

@media (max-width: 700px){
  .streaming-links{
    flex-wrap: wrap;
  }
}

/* Social glows */
.stream-btn[data-platform="instagram"]{
  --glow: rgba(193, 53, 132, .35);
}

.stream-btn[data-platform="facebook"]{
  --glow: rgba(24, 119, 242, .35);
}

.stream-btn[data-platform="tiktok"]{
  --glow: rgba(255, 0, 80, .30);
}

.stream-btn[data-platform="x"]{
  --glow: rgba(255,255,255,.25);
}

/* Subtle platform-specific glows */
.stream-btn[data-platform="youtube"]{      --glow: rgba(255, 0, 0, .35); }
.stream-btn[data-platform="spotify"]{      --glow: rgba(29, 185, 84, .35); }
.stream-btn[data-platform="apple"]{        --glow: rgba(255, 255, 255, .25); }
.stream-btn[data-platform="youtubemusic"]{ --glow: rgba(255, 0, 0, .28); }
.stream-btn[data-platform="bandcamp"]{     --glow: rgba(30, 180, 200, .30); }
.stream-btn[data-platform="soundcloud"]{   --glow: rgba(255, 85, 0, .30); }

.downloads{
  margin-top: 12px;
  padding-top: 10px;
  border-top: 1px solid rgba(255,255,255,.16);
}

.downloads-title{
  font-size: 12px;
  font-weight: 900;
  letter-spacing: .2px;
  color: rgba(255,255,255,.92);
  margin: 0 0 8px;
  text-align:center;
}

.downloads-row{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  justify-content:center;
}

.download-btn{
  padding:7px 12px;
  border-radius:999px;
  font-size:12px;
  font-weight:800;
  text-decoration:none;
  border:1px solid rgba(255,255,255,.20);
  background: rgba(0,0,0,.12);
  color:#fff;
  transition: transform .18s ease, box-shadow .18s ease, background .18s ease;
  white-space:nowrap;
}

.download-btn:hover{
  transform: translateY(-2px);
  background: rgba(0,0,0,.18);
  box-shadow: 0 10px 24px rgba(0,0,0,.22);
}

/* Centered section headings inside the detail panel (matches Downloads style) */
.panel-head{
  position: relative;
  text-align:center;
  margin: 12px 0 6px;
  font-size: 12px;
  font-weight: 1000;
  letter-spacing: .8px;
  text-transform: uppercase;
  color: rgba(255,255,255,.95);
}

/* Glow underline */
.panel-head::after{
  content: "";
  display: block;
  width: 48px;                      /* underline width */
  height: 2px;
  margin: 8px auto 0;

  border-radius: 2px;

  background: linear-gradient(
    90deg,
    rgba(255,255,255,.0),
    rgba(255,255,255,.7),
    rgba(255,255,255,.0)
  );

  box-shadow:
    0 0 6px rgba(255,255,255,.35),
    0 0 12px rgba(255,255,255,.15);

  opacity: .85;
}

.download-list{
  margin-top: 12px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.download-item{
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 14px;
  border-radius: 14px;
  background: rgba(255,255,255,.08);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255,255,255,.12);
  transition: background .2s ease, transform .2s ease;
}

.download-item:hover{
  background: rgba(255,255,255,.14);
  transform: translateY(-2px);
}

.dl-title{
  font-weight: 800;
  font-size: 14px;
  color: #fff;
}

.dl-meta{
  font-size: 12px;
  opacity: .75;
  margin-top: 2px;
}

.dl-btn{
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 8px 14px;
  border-radius: 999px;
  text-decoration: none;
  font-size: 12px;
  font-weight: 900;
  background: rgba(255,255,255,.12);
  border: 1px solid rgba(255,255,255,.2);
  color: #fff;
  transition: all .2s ease;
}

.dl-btn:hover{
  background: rgba(255,255,255,.22);
  box-shadow: 0 8px 20px rgba(0,0,0,.25);
}

/* Only hide the old primary CTA if you still need to */
.primary-cta{
  display:none !important;
}

.panel-head-playlist{
  margin-top: 30px;   /* increase this if you want more space */
  font-size: 13px;
}

/* Spotify/embed wrapper (single source of truth) */
.embed-wrap{
  position: relative;
  margin: 12px 0 0;     /* space above the player */
  padding: 0;           /* IMPORTANT: no padding = no fake empty area */
  background: transparent;
  border: 0;
  min-height: 0;
  height: auto;
}

/* Prevent iframe baseline gaps */
.embed-wrap iframe{
  display:block;
  width:100%;
  border:0;
}

/* Control the space AFTER the player by controlling what's NEXT */
.panel-head-downloads{
  margin-top: 10px;     /* this is the gap between player and Downloads heading */
}

/* Pull the Downloads header upward so it sits closer to Spotify */
.panel-head-downloads{
  margin-top: 10px !important;     /* try 10–14px */
}

.video-embed{
  position: relative;
  width: 100%;
  aspect-ratio: 16 / 9;
  border-radius: 16px;
  overflow: hidden;
  box-shadow: 0 18px 50px rgba(0,0,0,.28);
  border: 1px solid rgba(255,255,255,.16);
  background: rgba(0,0,0,.10);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
}

.video-embed iframe{
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  display: block;
  border: 0;
}

#detailPanel{
  scroll-margin-top: 110px; /* adjust if needed */
}

.mobile-hint{
  display:none;
  padding:10px 12px;
  border-radius: 999px;
  border:1px solid rgba(255,255,255,.18);
  background: rgba(255,255,255,.20);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  box-shadow: 0 10px 22px rgba(20,20,26,.08);
  font-size:12px;
  font-weight:800;
  color:#1a1a1a;
  white-space:nowrap;
}

/* MOBILE behavior */
@media (hover: none) and (pointer: coarse){
  #stopAudio{ display:none !important; }
  .mobile-hint{ display:inline-flex; align-items:center; gap:8px; }
}

/* MOBILE: remove the entire hover/status strip */
@media (hover: none) and (pointer: coarse){
  .status-row{
    display: none !important;
  }
}

/* ===== MERCH GRID (2 columns always) ===== */
.merch-grid{
  margin-top: 12px;
  display:grid;
  grid-template-columns: repeat(2, minmax(0,1fr)); /* ✅ always 2 columns */
  gap: 10px;
}

.merch-card{
  display:block;
  text-decoration:none;
  border-radius: 16px;
  overflow:hidden;

  border: 1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.08);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);

  box-shadow: 0 10px 22px rgba(0,0,0,.20);
  transition: transform .18s ease, background .18s ease, border-color .18s ease, box-shadow .18s ease;
}

.merch-card:hover{
  transform: translateY(-2px);
  background: rgba(255,255,255,.14);
  border-color: rgba(255,255,255,.24);
  box-shadow: 0 12px 30px rgba(0,0,0,.22);
}

/* ✅ This is the key: cap the image height */
.merch-img{
  width:100%;
  height: 210px;          /* ✅ makes them NOT huge */
  display:block;
  object-fit: cover;      /* crops tall model shots nicely */
  background: rgba(255,255,255,.06);
}

@media (max-width: 420px){
  .merch-img{ height: 170px; }  /* small phones */
}

.merch-title{
  padding: 10px 12px;
  font-weight: 900;
  font-size: 12px;
  color: #1a1a1a;
  line-height: 1.2;
}

.home-logo{
  display:flex;
  justify-content:center;
  align-items:center;
  padding: 10px 0 6px;
}

.home-logo img{
  width: min(420px, 85%);
  height: auto;
  object-fit: contain;
  display:block;

  /* optional pop */
  filter:
    drop-shadow(0 0 10px rgba(255,255,255,.18))
    drop-shadow(0 18px 40px rgba(0,0,0,.22));

  /* KEY: make transforms look like they're hinged at the body */
  transform-origin: 50% 55%;
  transition: transform 220ms ease, filter 220ms ease;
  will-change: transform;
}

/* hover flap */
.home-logo:hover img{
  animation: wingFlap 520ms ease-in-out infinite;
  filter:
    drop-shadow(0 0 16px rgba(255,255,255,.22))
    drop-shadow(0 22px 55px rgba(0,0,0,.28));
}

/* Stop flapping on touch devices where hover is weird */
@media (hover: none) and (pointer: coarse){
  .home-logo:hover img{ animation: none; }
}

@keyframes wingFlap{
  0%   { transform: translateY(0) rotate(0deg) scaleX(1) scaleY(1); }
  20%  { transform: translateY(1px) rotate(-1.2deg) scaleX(1.01) scaleY(.96); }
  50%  { transform: translateY(-2px) rotate(1.2deg)  scaleX(.99) scaleY(1.04); }
  80%  { transform: translateY(1px) rotate(-.6deg) scaleX(1.01) scaleY(.97); }
  100% { transform: translateY(0) rotate(0deg) scaleX(1) scaleY(1); }
}

.news-list{
  margin-top: 10px;
  display:flex;
  flex-direction:column;
  gap:10px;
}

.news-item{
  padding: 12px 14px;
  border-radius: 14px;
  background: rgba(255,255,255,.08);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255,255,255,.12);
  box-shadow: 0 10px 22px rgba(0,0,0,.12);
}

.news-date{
  font-size: 11px;
  font-weight: 900;
  letter-spacing: .6px;
  text-transform: uppercase;
  opacity: .8;
}

.news-title{
  margin-top: 4px;
  font-size: 14px;
  font-weight: 950;
}

.news-text{
  margin-top: 6px;
  font-size: 13px;
  line-height: 1.35;
  opacity: .92;
}

.release-list{
  margin-top: 10px;
  display:flex;
  flex-direction:column;
  gap:12px;
}

.release-item{
  padding: 12px 14px;
  border-radius: 16px;
  background: rgba(255,255,255,.08);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255,255,255,.12);
  box-shadow: 0 10px 22px rgba(0,0,0,.12);
}

.release-top{
  display:flex;
  gap:12px;
  align-items:flex-start;
}

.release-cover{
  width: 86px;
  height: 86px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,.14);
  object-fit: cover;
  background: rgba(255,255,255,.06);
  flex: 0 0 auto;
}

.release-cover.placeholder{
  display:block;
}

.release-meta{
  min-width: 0;
  flex: 1 1 auto;
}

.release-date{
  font-size: 11px;
  font-weight: 900;
  letter-spacing: .6px;
  text-transform: uppercase;
  opacity: .8;
  color: #fff;
}

.release-title{
  margin-top: 4px;
  font-size: 15px;
  font-weight: 950;
  color: #fff;
  line-height: 1.15;
}

.release-type{
  margin-top: 4px;
  font-size: 12px;
  font-weight: 800;
  opacity: .85;
  color: #fff;
}

.release-blurb{
  margin-top: 8px;
  font-size: 13px;
  line-height: 1.35;
  opacity: .92;
  color: #fff;
}

.release-links{
  margin-top: 10px;
  display:flex;
  flex-wrap: wrap;
  gap:8px;
  justify-content:center;
}

  </style>
</head>

<body>
  <!-- Custom animated cursor -->
  <div class="mm-cursor" id="mmCursor" aria-hidden="true"><img id="mmCursorImg" alt="" /></div>
  <div class="grain"></div>

  <header>
    <div class="wrap">
      <div class="topbar">

  <!-- LEFT: Bird logo -->
  <div class="logo-mark">
  <a href="/">
    <img src="assets/Official Logo NoTest Transparent.png" alt="Magpie Logo">
  </a>
</div>

  <!-- CENTER: Band name -->
  <div class="brand-text">
    <a href="/">
	<img src="assets/magpie menace text only.png" alt="Magpie Menace">
    </a>
  </div>

  <!-- RIGHT: Buttons -->
  <div class="actions">
    <a class="pill" href="#" id="tipLink" target="_blank" rel="noopener">Tip Jar</a>
    <a class="pill" href="#" id="joinMailing">Magpie Militia</a>
    <a class="pill" href="#" id="bookUs">Book Us</a>
  </div>

</div>
    </div>
  </header>


  <main class="stage" id="stageRoot">

  <!-- TOP LINKS ROW (tiles injected here) -->
  <nav class="top-links" aria-label="Site sections">
    <div id="topLinks" class="top-links-row">
      <!-- Tiles injected by JS -->
    </div>
  </nav>
  
  <div class="status-row" aria-label="Playback status">
  <div class="now-playing" aria-live="polite">
    <div class="dot" aria-hidden="true"></div>
    <span id="nowPlaying">Hover a section to play a preview</span>
  </div>
	
	<div class="mobile-hint" id="mobileHint" aria-hidden="true">
  Tap a section to open details ↓
</div>

  <button class="pill stop-pill" type="button" id="stopAudio" aria-live="polite">
    <span class="wave" aria-hidden="true"><i></i><i></i><i></i></span>
    <span class="stop-label" id="stopLabel">Stopped</span>
  </button>
</div>

  <!-- CENTER STAGE (your center panel stays) -->
  <section class="center-stage" aria-label="Center stage">

    <div class="center-hero">
      <div>
        <h2 id="heroTitle">Welcome to the nest.</h2>
        <p id="heroText">Hover a section to hear a song sample and see details here. On mobile, tap a section.</p>
      </div>
    </div>

    <aside class="detail-card" id="detailPanel" aria-label="Section details">
      <div class="detail-head">
        <div>
          <h3 id="detailTitle">Magpie Menace</h3>
          <p id="detailSubtitle">Choose a section to explore.</p>
        </div>
      </div>

      <div class="detail-body">
      <div id="detailContent">
  <div class="home-logo">
    <img src="assets/Official Logo NoTest Transparent.png" alt="Magpie Menace logo">
  </div>
</div>

<!-- ✅ Put tip jar OUTSIDE detailContent so it never gets wiped -->
<div id="tipJarWrap">
  <div class="qr" id="tipJarBlock">
    <div class="qr-codes">

      <div class="qr-item">
        <a id="paypalLink" href="#" target="_blank" rel="noopener">
          <img id="qrPaypal" alt="PayPal QR code" />
        </a>
        <div class="qr-label">PayPal</div>
      </div>

      <div class="qr-item">
        <a id="cashAppLink" href="#" target="_blank" rel="noopener">
          <img id="qrCashApp" alt="Cash App QR code" />
        </a>
        <div class="qr-label">Cash App</div>
      </div>

      <div class="qr-item">
        <a id="venmoLink" href="#" target="_blank" rel="noopener">
          <img id="qrVenmo" alt="Venmo QR code" />
        </a>
        <div class="qr-label">Venmo</div>
      </div>

    </div>
  </div>

  <div class="qr-text">
    <div style="font-weight:850; margin-bottom:6px;">Support the Band</div>
    <div class="support-note">We appreciate any and all tips. Thank you for keeping music alive!</div>
  </div>
</div>
        </div>

    </aside>

  </section>

  <!-- Audio elements (JS will control playback) -->
  <div style="display:none" aria-hidden="true" id="audioRack"></div>
</main>

  <footer>
    © <span id="year"></span> Magpie Menace · Built with love and stolen sparkle.
  </footer>

  <script>
    // ============================
    // 1) CONFIG — update these
    // ============================

    const TIP_JAR_URL = "https://www.paypal.com/ncp/payment/T49SSHQQ2MZ74"; // <-- replace (PayPal.me / Venmo / Ko-fi / etc.)
	const CASHAPP_URL = "https://cash.app/$MagpieMenace";
	const VENMO_URL = "https://venmo.com/u/MagpieMenace";

    // Replace these placeholders with your real links and preview audio files.
    // Put shiny object PNGs/JPGs under /assets and audio previews under /audio.
    const SECTIONS = [
      {
        id: "music",
        title: "Music",
        kicker: "Downloads • Streaming",
        shinyBg: "assets/shiny-record.png",
        cursorSrc: "assets/cursor-magpie-music.png",
        previewSrc: "audio/music-preview.mp3",
        subtitle: "Stream it, buy it, steal it (legally).",
        links: [
		{ platform: "youtube",      name: "YouTube",      url: "https://www.youtube.com/@MagpieMenace/videos" },
		{ platform: "spotify",      name: "Spotify",      url: "https://open.spotify.com/artist/09S4illm5MXKZdRnzzm3CH?si=IyW7bHRETPeLLA4TA0uHaQ" },
		{ platform: "apple",        name: "Apple Music",  url: "https://music.apple.com/us/artist/magpie-menace/1789389483" },
		{ platform: "youtubemusic", name: "YouTube Music",url: "https://music.youtube.com/channel/UCOdAZpz9Oyc08QnhJ5YeNFw" },
		{ platform: "bandcamp",     name: "Bandcamp",     url: "https://magpiemenace.bandcamp.com" },
		{ platform: "soundcloud",   name: "SoundCloud",   url: "https://soundcloud.com/magpie-menace" }
		],
		downloads: [
  { title: "Help",     url: "https://downloads.magpiemenace.com/dl/help", meta: "MP3 • 6.3MB" },
  { title: "Midwest Goodbye", url: "https://downloads.magpiemenace.com/dl/midwest", meta: "MP3 • 5.8MB" },
  { title: "Out Of My Head",      url: "https://downloads.magpiemenace.com/dl/outofmyhead", meta: "MP3 • 7.1MB" }
],

		bullets: [],
        ctaText: "Listen",
        ctaHref: "#",
		
		embed: `
  <iframe style="border-radius:16px"
    src="https://open.spotify.com/embed/playlist/0NFM3PoeiTbxt4R73QgXim?utm_source=generator&theme=0"
    width="95%"
    height="175"
    frameborder="0"
    allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
    loading="lazy">
  </iframe>
`,
  },
      {
        id: "videos",
        title: "Videos",
        kicker: "Clips • Live • Official",
        shinyBg: "assets/shiny-camera.png",
        cursorSrc: "assets/cursor-magpie-videos.png",
        previewSrc: "audio/videos-preview.mp3",
        subtitle: "Music videos, live cuts, and questionable decisions.",
        
		// ✅ Add this:
  embed: `
    <div class="video-embed">
      <iframe
        src="https://www.youtube-nocookie.com/embed/videoseries?list=PLhbt3ddH0jvPNCHiSO1o0hSWs0WVlOhkX&rel=0"
        title="Magpie Menace videos"
        frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
        allowfullscreen
        loading="lazy">
      </iframe>
    </div>
  `,
  
		bullets: [],
        ctaText: "Watch",
        ctaHref: "https://www.youtube.com/@MagpieMenace/videos"
      },
      {
  id: "social",
  title: "Social Media",
  kicker: "Follow the chaos",
  shinyBg: "assets/shiny-social.png",
  cursorSrc: "assets/cursor-magpie-social.png",
  previewSrc: "audio/social-preview.mp3",
  subtitle: "Announcements, clips, memes, and shinies.",

  links: [
    {
      platform: "instagram",
      name: "Instagram",
      url: "https://www.instagram.com/magpiemenaceband/"
    },
    {
      platform: "facebook",
      name: "Facebook",
      url: "https://www.facebook.com/MagpieMenace"
    },
    {
      platform: "tiktok",
      name: "TikTok",
      url: "https://www.tiktok.com/@magpiemenaceband"
    },
    {
      platform: "x",
      name: "X",
      url: "https://x.com/Magpie__Menace"
    }
  ]
},
      {
  id: "merch",
  title: "Merch",
  kicker: "Tees • Stickers • Trinkets",
  shinyBg: "assets/shiny-shirt.png",
  cursorSrc: "assets/cursor-magpie-merch.png",
  previewSrc: "audio/merch-preview.mp3",
  subtitle: "Wear the omen.",

  shopUrl: "https://magpiemenace.myspreadshop.com/",

  products: [
    {
      title: "Official Logo Tee",
      url: "https://magpiemenace.myspreadshop.com/official+logo+transparent-A68c9648dca8b7575e7c015fe?productType=812&sellable=BvJzXRqMryID1ZlEox8B-812-7&appearance=566",
      img: "https://image.spreadshirtmedia.com/image-server/v1/products/T812A386PA4267PT17X104Y58D1057796575W13821H17864/views/1,width=650,height=650,appearanceId=566,backgroundColor=ffffff,crop=detail,modelId=1237/magpie-menace-official-band-logo.jpg"
    },
    {
      title: "Skull See-Saw (Women’s Tee)",
      url: "https://magpiemenace.myspreadshop.com/magpies+skull+see+saw+perch+on+skull-A683c9dc5833c9939447897e3?productType=347&sellable=OL3mbnrQeyHjMqeMAMQA-347-8&appearance=386",
      img: "https://image.spreadshirtmedia.com/image-server/v1/products/T347A386PA4306PT17X38Y31D1057318889W17598H17598/views/1,width=650,height=650,appearanceId=386,backgroundColor=ffffff,crop=detail,modelId=2564/magpie-menace-band-logo-featuring-two-australian-magpies-perched-on-a-seesaw-balanced-on-a-skull.jpg"
    },
    {
      title: "Skull See-Saw (Tie-Dye)",
      url: "https://magpiemenace.myspreadshop.com/magpies+skull+see+saw+perch+on+skull-A683c9dc5833c9939447897e3?productType=491&sellable=OL3mbnrQeyHjMqeMAMQA-491-8&appearance=1123",
      img: "https://image.spreadshirtmedia.com/image-server/v1/products/T491A1123PA4308PT17X40Y37D1057318889W25000H25000/views/1,width=650,height=650,appearanceId=1123,backgroundColor=ffffff/magpie-menace-band-logo-featuring-two-australian-magpies-perched-on-a-seesaw-balanced-on-a-skull.jpg"
    },
    {
      title: "Pumping Iron Hoodie",
      url: "https://magpiemenace.myspreadshop.com/magpie+menace+band+magpies+pumping+iron-A68447cb238282b50dc412a55?productType=111&sellable=AbDv05ablzHvq03yEJXZ-111-22&appearance=1",
      img: "https://image.spreadshirtmedia.com/image-server/v1/products/T111A1PA4247PT17X70Y22D1057347778W20844H20844/views/1,width=650,height=650,appearanceId=1,backgroundColor=ffffff,crop=detail,modelId=12749/magpie-menace-band-magpies-pumping-iron.jpg"
    },
	{
      title: "Official Logo Coffee Mug",
      url: "https://magpiemenace.myspreadshop.com/official+logo+transparent-A68c9648dca8b7575e7c015fe?productType=268&sellable=BvJzXRqMryID1ZlEox8B-268-32&appearance=70",
      img: "https://image.spreadshirtmedia.com/image-server/v1/products/T268A544PA5007PT10X11Y8D1057796575W3731H4823/views/3,width=650,height=650,appearanceId=70,backgroundColor=ffffff,crop=detail,modelId=11639/magpie-menace-official-band-logo.jpg"
    },
	{
      title: "Official Logo Water Bottle",
      url: "https://magpiemenace.myspreadshop.com/official+logo+transparent-A68c9648dca8b7575e7c015fe?productType=757&sellable=BvJzXRqMryID1ZlEox8B-757-39&appearance=1",
      img: "https://image.spreadshirtmedia.com/image-server/v1/products/T757A1PA4077PT10X11Y8D1057796575W3731H4823/views/3,width=650,height=650,appearanceId=1,backgroundColor=ffffff,crop=detail,modelId=11657/magpie-menace-official-band-logo.jpg"
    }
  
  ],

  ctaText: "Shop All Merch",
  ctaHref: "https://magpiemenace.myspreadshop.com/"
},
      {
        id: "news",
        title: "News",
        kicker: "Updates • Tour • Press",
        shinyBg: "assets/shiny-newspaper.png",
        cursorSrc: "assets/cursor-magpie-news.png",
        previewSrc: "audio/news-preview.mp3",
        subtitle: "Updates from the nest.",
        bullets: [],
		posts: [
    {
      date: "Feb 2026",
      title: "Big News!",
      text: "Magpie Menace is about to shock the world. We will let you know more details at the beginning of March 2026."
    },
	{
      date: "Feb 2026",
      title: "New website",
      text: "Magpie Menace launches magpiemenace.com website!"
    },
	{
      date: "Feb 2026",
      title: "New Single: Koozie Vows",
      text: "Magpie Menace has released our first single of 2026. It's called Koozie Vows, and you can guess what it's about....or can you?"
    },
	{
      date: "Dec 2025",
      title: "Year in review",
      text: "Magpie Menace had a very productive 2025. We released 11 singles in total, and completed a couple more that were not released."
    },
    {
      date: "Jan 2025",
      title: "Magpie Menace has hatched",
      text: "On January 17, 2025, Magpie Menace released its first song ever, Out of My Head."
    }
  ],
  ctaText: "More",
        ctaHref: "#"
      },
      
	  {
  id: "releases",
  title: "Releases",
  kicker: "Singles • EPs • Albums",
  shinyBg: "assets/shiny-vinyl.png",
  cursorSrc: "assets/cursor-magpie-releases.png",
  previewSrc: "audio/releases-preview.mp3",
  subtitle: "A timeline of shiny noise.",
  releases: [
    {
      date: "2-13-2026",
      title: "Koozie Vows",
      type: "Single",
      cover: "assets/Koozie-Vows-Camo-Cover.png",
      blurb: "Vows we thought would last.",
      links: [
        { platform: "spotify", name: "Spotify", url: "https://open.spotify.com/track/39cN2nSwOGvBh3nVVs8yML?si=19a13b01d62d43bd" },
        { platform: "apple", name: "Apple Music", url: "https://music.apple.com/us/album/koozie-vows-single/1872209331" },
        { platform: "youtube", name: "YouTube", url: "https://youtu.be/jbn8_Cqa0eQ?si=r4JAnwMBzYIaQ6vt" },
        { platform: "bandcamp", name: "Bandcamp", url: "https://magpiemenace.bandcamp.com/track/koozie-vows" }
      ]
    },
    {
      date: "12-24-2025",
      title: "Suffocation",
      type: "Single",
      cover: "assets/Suffocation-Cover.png",
      blurb: "A bear hug from life.",
      links: [
        { platform: "spotify", name: "Spotify", url: "https://open.spotify.com/track/5859YShAuk1bicGi16uWv3?si=698afc61a9074723" },
        { platform: "apple", name: "Apple Music", url: "https://music.apple.com/us/album/suffocation-single/1865181404" },
        { platform: "youtube", name: "YouTube", url: "https://youtu.be/yWYeVhjru_E?si=5VENBpKqDePxbg8A" },
		{ platform: "bandcamp", name: "Bandcamp", url: "https://magpiemenace.bandcamp.com/track/suffocation" }
      ]
    },
	{
      date: "11-28-2025",
      title: "Reflections",
      type: "Single",
      cover: "assets/Reflections-Cover.png",
      blurb: "Sometimes it's good to look back.",
      links: [
        { platform: "spotify", name: "Spotify", url: "https://open.spotify.com/track/0B7E3Ud34KFTkUTOtNLfvX?si=62e4de6e7dfb4e8c" },
        { platform: "apple", name: "Apple Music", url: "https://music.apple.com/us/album/reflections-single/1854665812" },
        { platform: "youtube", name: "YouTube", url: "https://youtu.be/h5fUgNm1HkM?si=XKL4XjKMiaZav5tp" },
        { platform: "bandcamp", name: "Bandcamp", url: "https://magpiemenace.bandcamp.com/track/reflections" }
      ]
    },
	{
      date: "11-28-2025",
      title: "Who I Am",
      type: "Single",
      cover: "assets/Who-I-Am-Cover.png",
      blurb: "Discovering oneself amidst others' expectations.",
      links: [
        { platform: "spotify", name: "Spotify", url: "https://open.spotify.com/track/1OIla8Fux3lj94TsvrY0Ps?si=13d44a0e37ad42cd" },
        { platform: "apple", name: "Apple Music", url: "https://music.apple.com/us/album/who-i-am-single/1854949871" },
        { platform: "youtube", name: "YouTube", url: "https://youtu.be/uM0HTmqbLZc?si=1VqlJectaDmplCKv" },
        { platform: "bandcamp", name: "Bandcamp", url: "https://magpiemenace.bandcamp.com/track/who-i-am" }
      ]
    },
	{
      date: "10-31-2025",
      title: "Help",
      type: "Single",
      cover: "assets/HELP-Cover.png",
      blurb: "Behind every addiction is a human.",
      links: [
        { platform: "spotify", name: "Spotify", url: "https://open.spotify.com/track/4R2O9d8LluAMSbyuCyhdgM?si=b2a606cf2d614518" },
        { platform: "apple", name: "Apple Music", url: "https://music.apple.com/us/album/help-single/1841731978" },
        { platform: "youtube", name: "YouTube", url: "https://youtu.be/7lmoXPy_I6A?si=hFSg5T0mdJZZNqqk" },
        { platform: "bandcamp", name: "Bandcamp", url: "https://magpiemenace.bandcamp.com/track/help" }
      ]
    },
	{
      date: "9-26-2025",
      title: "Masquerade",
      type: "Single",
      cover: "assets/Masquerade-Cover.png",
      blurb: "What lies behind the mask of illusions?",
      links: [
        { platform: "spotify", name: "Spotify", url: "https://open.spotify.com/track/1zSmetzmue49byOp9tl96l?si=cc51ce02b2054e5b" },
        { platform: "apple", name: "Apple Music", url: "https://music.apple.com/us/album/masquerade-single/1843000701" },
        { platform: "youtube", name: "YouTube", url: "https://youtu.be/_UclBZo1-_E?si=RA06U-qIFCZbhp3M" },
        { platform: "bandcamp", name: "Bandcamp", url: "https://magpiemenace.bandcamp.com/track/masquerade" }
      ]
    },
	{
      date: "6-29-2025",
      title: "Until It Happens To You",
      type: "Single",
      cover: "assets/Until-It-Happens-to-You-Cover.png",
      blurb: "It's frustrating to be judged by someone who hasn't been through what you are going through.",
      links: [
        { platform: "spotify", name: "Spotify", url: "https://open.spotify.com/track/42IfKc78NnT6s8GKnUx33U?si=5d96d19ff9234c98" },
        { platform: "apple", name: "Apple Music", url: "https://music.apple.com/us/album/until-it-happens-to-you-single/1823365789" },
        { platform: "youtube", name: "YouTube", url: "https://youtu.be/I8VukJ55ZCk?si=dZCMfBzDMrZfdfzC" },
        { platform: "bandcamp", name: "Bandcamp", url: "https://magpiemenace.bandcamp.com/track/until-it-happens-to-you" }
      ]
    },
	{
      date: "5-26-2025",
      title: "Midwest Goodbye (Featuring Geoff White)",
      type: "Single",
      cover: "assets/Midwest-Goodbye-Cover.png",
      blurb: "A goodbye that hits like headlights in the rearview.",
      links: [
        { platform: "spotify", name: "Spotify", url: "https://open.spotify.com/track/0HB0o2kvOSdXrPcoRnOzrj?si=2ddd2bd45706426c" },
        { platform: "apple", name: "Apple Music", url: "https://music.apple.com/us/album/midwest-goodbye-feat-geoff-white-single/1816587986" },
        { platform: "youtube", name: "YouTube", url: "https://youtu.be/LHg4dW8tP0o?si=niF5NS3GNp5lPDS_" },
        { platform: "bandcamp", name: "Bandcamp", url: "https://magpiemenace.bandcamp.com/track/magpie-menace-featuring-geoff-white-midwest-goodbye" }
      ]
    },
	{
      date: "5-16-2025",
      title: "Eternity",
      type: "Single",
      cover: "assets/Eternity-Cover.png",
      blurb: "A song about eternal love.",
      links: [
        { platform: "spotify", name: "Spotify", url: "https://open.spotify.com/track/7gq9ZHdYgOJxryrhOlnC6V?si=f8def89d029a498f" },
        { platform: "apple", name: "Apple Music", url: "https://music.apple.com/us/album/eternity-single/1812695801" },
        { platform: "youtube", name: "YouTube", url: "https://youtu.be/M7eNNKcKyJ4?si=scDAo0HTq9rUe7EA" },
        { platform: "bandcamp", name: "Bandcamp", url: "https://magpiemenace.bandcamp.com/track/eternity" }
      ]
    },
	{
      date: "3-21-2025",
      title: "Kaleidoscopin'",
      type: "Single",
      cover: "assets/Kaleidoscopin-Cover.png",
      blurb: "Open up your mind and begin to see the truth.",
      links: [
        { platform: "spotify", name: "Spotify", url: "https://open.spotify.com/track/5xUhaxeKPNkCpBeb7V7XVG?si=3f52723409254b82" },
        { platform: "apple", name: "Apple Music", url: "https://music.apple.com/us/album/kaleidoscopin-single/1802911489" },
        { platform: "youtube", name: "YouTube", url: "https://youtu.be/vJ1hzOsQD7I?si=YUeTdmif56LQK6Sr" },
        { platform: "bandcamp", name: "Bandcamp", url: "https://magpiemenace.bandcamp.com/track/kaleidoscopin" }
      ]
    },
	{
      date: "2-2-2025",
      title: "Let's Fly",
      type: "Single",
      cover: "assets/Lets-Fly-Cover.png",
      blurb: "Life is but a dream.",
      links: [
        { platform: "spotify", name: "Spotify", url: "https://open.spotify.com/track/30aonDe4bt8OL2fU3qj4z0?si=7b008076ed1a4ce6" },
        { platform: "apple", name: "Apple Music", url: "https://music.apple.com/us/album/lets-fly-single/1792982462" },
        { platform: "youtube", name: "YouTube", url: "https://youtu.be/G81hY315r1s?si=wLn2VPuTmVbjDVka" },
        { platform: "bandcamp", name: "Bandcamp", url: "https://magpiemenace.bandcamp.com/track/lets-fly" }
      ]
    },
	{
      date: "1-17-2025",
      title: "Out of My Head Logo.png",
      type: "Single",
      cover: "assets/Out-of-My-Head-Cover.png",
      blurb: "It's hard to stop thinking about the trials of love.",
      links: [
        { platform: "spotify", name: "Spotify", url: "https://open.spotify.com/track/3KeEEn50tfGb9OitZLSgAh?si=e906853486254f30" },
        { platform: "apple", name: "Apple Music", url: "https://music.apple.com/us/album/out-of-my-head-single/1789390136" },
        { platform: "youtube", name: "YouTube", url: "https://youtu.be/NaHJQ72iYoc?si=dKausbWuopKYy5nI" },
        { platform: "bandcamp", name: "Bandcamp", url: "https://magpiemenace.bandcamp.com/track/out-of-my-head" }
      ]
    }
	
  ]
},
      {
        id: "militia",
        title: "Magpie Militia",
        kicker: "Fan club",
        shinyBg: "assets/shiny-badge.png",
        cursorSrc: "assets/cursor-magpie-militia.png",
        previewSrc: "audio/militia-preview.mp3",
        subtitle: "Join the flock. Get perks. Be first to the shinies.",
        bullets: [
          "Early demos + secret videos",
          "Discount codes",
          "Private announcements"
        ],
        ctaText: "Join",
        ctaHref: "#"
      }
    ];

    // ============================
    // 2) RENDER
    // ============================

    const tilesEl = document.getElementById('topLinks');
    const audioRack = document.getElementById('audioRack');

    const heroTitle = document.getElementById('heroTitle');
    const heroText = document.getElementById('heroText');
    const nowPlaying = document.getElementById('nowPlaying');

    const detailTitle = document.getElementById('detailTitle');
    const detailSubtitle = document.getElementById('detailSubtitle');
    const detailContent = document.getElementById('detailContent');
    const primaryCta = document.getElementById('primaryCta');

// ============================
// HOME (default Magpie Menace view)
// ============================

// Capture the initial home state from the DOM (before setDetails() ever runs)
const HOME_TITLE = detailTitle.textContent || "Magpie Menace";
const HOME_SUBTITLE = detailSubtitle.textContent || "Choose a section to explore.";

// Build a reusable "home" body (avoid cloning IDs by reusing the existing tipJarBlock node)
function buildHomeBody(){
  const frag = document.createDocumentFragment();

  const wrap = document.createElement('div');
  wrap.className = 'home-logo';
  wrap.innerHTML = `
    <img src="assets/Official Logo NoTest Transparent.png" alt="Magpie Menace logo">
  `;
  frag.appendChild(wrap);

  return frag;
}

function showHome(){
  // Reset title/subtitle
  detailTitle.textContent = HOME_TITLE;
  detailSubtitle.textContent = HOME_SUBTITLE;

  // Reset right panel content
  detailContent.innerHTML = "";
  detailContent.appendChild(buildHomeBody());

  // Optional: reset cursor + status text to "home" feel
  setCursorBig(false);
  setCursorSrc('assets/cursor-magpie.png');

  if (typeof stopAll === "function") stopAll(); // stop any preview audio
  if (typeof updateStopButton === "function") updateStopButton();

  const np = document.getElementById('nowPlaying');
  if (np) np.textContent = 'Hover a section to play a preview';
}
	// Custom cursor state
const cursorEl = document.getElementById('mmCursor');
const cursorImg = document.getElementById('mmCursorImg');
let cursorX = -9999, cursorY = -9999;

function setCursorSrc(src){
  cursorImg.src = src || 'assets/cursor-magpie.png';
}

// Set default cursor
setCursorSrc('assets/cursor-magpie.png');

function moveCursor(x, y){
  cursorX = x; cursorY = y;
  // Vars used by peck animation
  cursorEl.style.setProperty('--x', `${x}px`);
  cursorEl.style.setProperty('--y', `${y}px`);
  cursorEl.style.transform = `translate3d(${x}px, ${y}px, 0)`;
}

function isMobileish(){
  // "hover: none" catches touch devices better than screen width alone
  return window.matchMedia('(hover: none) and (pointer: coarse)').matches
    || window.innerWidth <= 720;
}

function scrollToDetails(){
  const panel = document.getElementById('detailPanel');
  if(!panel) return;

  // First scroll immediately
  panel.scrollIntoView({ behavior: 'smooth', block: 'start' });

  // Second scroll shortly after (catches layout shift from iframes)
  setTimeout(() => {
    panel.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }, 220);

  // If an iframe exists, scroll again after it finishes loading
  const iframe = panel.querySelector('iframe');
  if(iframe && !iframe.__mmScrollHooked){
    iframe.__mmScrollHooked = true;
    iframe.addEventListener('load', () => {
      panel.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }, { once: true });
  }
}

window.addEventListener('pointermove', (e)=>{
  // Slight offset so the image isn't under the pointer tip
  moveCursor(e.clientX + 6, e.clientY + 6);
});

function cursorPeck(){
  cursorEl.classList.remove('pecking');
  // force reflow so animation retriggers
  void cursorEl.offsetWidth;
  cursorEl.classList.add('pecking');
  cursorEl.addEventListener('animationend', () => cursorEl.classList.remove('pecking'), { once:true });
}

function setCursorBig(isBig){
  cursorEl.classList.toggle('big', !!isBig);
}

function spawnSparkles(x, y){
  const count = 7;
  for(let i=0;i<count;i++){
    const s = document.createElement('div');
    s.className = 'sparkle';
    const angle = Math.random() * Math.PI * 2;
    const dist = 26 + Math.random() * 28;
    const dx = Math.cos(angle) * dist;
    const dy = Math.sin(angle) * dist;
    s.style.setProperty('--sx', `${x}px`);
    s.style.setProperty('--sy', `${y}px`);
    s.style.setProperty('--dx', `${dx}px`);
    s.style.setProperty('--dy', `${dy}px`);
    document.body.appendChild(s);
    s.addEventListener('animationend', () => s.remove(), { once:true });
  }
}

    // Tip jar block
    const tipLink = document.getElementById('tipLink');
    const tipButton = document.getElementById('tipButton');
    const qrPaypal = document.getElementById('qrPaypal');
	const qrCashApp = document.getElementById('qrCashApp');
	const qrVenmo = document.getElementById('qrVenmo');

    function safeUrl(u){
      try{
        const url = new URL(u);
        return url.toString();
      }catch{
        return '#';
      }
    }

const paypalLink = document.getElementById('paypalLink');
const cashAppLink = document.getElementById('cashAppLink');
const venmoLink = document.getElementById('venmoLink');


function buildPaymentQrs(){
  qrPaypal.src  = "assets/qrcode-paypal.png";
  qrCashApp.src = "assets/qrcode-cashapp.png";
  qrVenmo.src   = "assets/qrcode-venmo.png";

  paypalLink.href  = TIP_JAR_URL;
  cashAppLink.href = CASHAPP_URL;
  venmoLink.href   = VENMO_URL;

  // Top “Tip Jar” should still go to your primary (PayPal here)
  tipLink.href = TIP_JAR_URL;

  // Only set this if the button exists
  if (tipButton) tipButton.href = TIP_JAR_URL;
}

buildPaymentQrs();

// Create audio elements
const audios = new Map();
let activeAudioId = null;
let fadeToken = 0;
let audioArmed = false;
const MQ_ANY_HOVER  = window.matchMedia('(any-hover: hover)');
const MQ_ANY_COARSE = window.matchMedia('(any-pointer: coarse)');

const CAN_HOVER = MQ_ANY_HOVER.matches;

// True on iPhone/Android and most touch devices
const TOUCH = (navigator.maxTouchPoints && navigator.maxTouchPoints > 0) || MQ_ANY_COARSE.matches;

// Treat as “mobile/touch-first” if it’s touch and not truly hover-first
const MOBILE = TOUCH && !CAN_HOVER;

// Hovering the header restores the main Magpie Menace "home" view (desktop only)
const headerEl = document.querySelector('header');
if (headerEl && CAN_HOVER){
  headerEl.addEventListener('mouseenter', showHome);
}

// Clicking the logo/name restores home without reloading
document.querySelectorAll('header a[href="/"]').forEach(a => {
  a.addEventListener('click', (e) => {
    e.preventDefault();
    showHome();
  });
});

// Layout breakpoint (just for scrolling/layout decisions)
const SMALL = window.innerWidth <= 720;

// Default: previews ON only for non-mobile
let audioEnabled = !MOBILE;
let musicEmbedCache = null; // holds Spotify DOM node so it doesn't reload

if (MOBILE) {
  // previews should never play on iPhone/Android
  audioEnabled = false;
  stopAll();
}

window.addEventListener('touchstart', () => {
  if (!MOBILE) return;
  audioEnabled = false;
  stopAll();
}, { passive: true });

async function armAudioOnce(){
  if(audioArmed) return true;

  const first = audios.get(SECTIONS[0].id);
  if(!first) return false;

  try{
    first.volume = 0;
    await first.play();
    first.pause();
    first.currentTime = 0;
    audioArmed = true;
    return true;
  } catch (err){
    console.warn('Audio blocked until user gesture:', err);
    return false;
  }
}

// Create audio elements
SECTIONS.forEach(s => {
  const a = document.createElement('audio');
  a.src = s.previewSrc;
  a.preload = 'auto';
  a.loop = true;
  a.volume = 0; // start muted; we'll fade in
  audioRack.appendChild(a);
  audios.set(s.id, a);
});

function fadeTo(audio, target, ms=220){
  if(!audio) return Promise.resolve();
  const start = audio.volume;
  const delta = target - start;
  const startTime = performance.now();
  return new Promise((resolve)=>{
    function tick(now){
      const t = Math.min(1, (now - startTime) / ms);
      audio.volume = Math.max(0, Math.min(1, start + delta * t));
      if(t < 1) requestAnimationFrame(tick);
      else resolve();
    }
    requestAnimationFrame(tick);
  });
}

async function crossfade(toId){
  const myToken = ++fadeToken;
  if(activeAudioId === toId) return;

  const prevId = activeAudioId;                 // <-- add
  const from = prevId ? audios.get(prevId) : null;
  const to = audios.get(toId);
  activeAudioId = toId;

  if(to){
    try{ await to.play(); } catch {}
  }

  await Promise.all([
    fadeTo(from, 0, 260).then(()=>{ if(from){ from.pause(); from.currentTime = 0; } }),
    fadeTo(to, 0.75, 260)
  ]);

  if(myToken !== fadeToken) return;
  updateStopButton();
  
}

    function stopAll(exceptId=null){
  audios.forEach((a, id) => {
    if(exceptId && id === exceptId) return;
    a.pause();
    a.currentTime = 0;
    a.volume = 0;
  });
  if(!exceptId) activeAudioId = null;
  updateStopButton();
}

const PLATFORM_ICONS = {
  youtube: `
    <svg viewBox="0 0 24 24">
      <path d="M23 12s0-3.6-.46-5.2a3 3 0 0 0-2.1-2.1C18.8 4 12 4 12 4s-6.8 0-8.44.7a3 3 0 0 0-2.1 2.1C1 8.4 1 12 1 12s0 3.6.46 5.2a3 3 0 0 0 2.1 2.1C5.2 20 12 20 12 20s6.8 0 8.44-.7a3 3 0 0 0 2.1-2.1C23 15.6 23 12 23 12Zm-13 3.5v-7l6 3.5-6 3.5Z"/>
    </svg>
  `,
  spotify: `
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path d="M12 2a10 10 0 1 0 .001 20.001A10 10 0 0 0 12 2Zm4.63 14.43a.9.9 0 0 1-1.24.29c-2.55-1.56-5.76-1.92-9.53-1.06a.9.9 0 1 1-.4-1.76c4.23-.96 7.89-.52 10.82 1.28.42.25.55.81.35 1.25Zm.88-2.64a1.05 1.05 0 0 1-1.44.34c-2.92-1.79-7.37-2.3-10.82-1.25a1.05 1.05 0 0 1-.61-2.01c3.95-1.2 8.86-.62 12.23 1.44.5.3.66.95.34 1.48Zm.07-2.83c-3.5-2.08-9.27-2.27-12.61-1.26a1.2 1.2 0 1 1-.7-2.29c3.84-1.16 10.22-.94 14.24 1.45a1.2 1.2 0 0 1-1.93 2.1Z"/>
    </svg>
  `,
  apple: `
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path d="M16.7 13.6c0-2 1.6-3 1.7-3.1-1-1.5-2.5-1.7-3-1.7-1.3-.1-2.5.8-3.2.8-.6 0-1.6-.8-2.7-.8-1.4 0-2.8.8-3.5 2.1-1.5 2.6-.4 6.4 1 8.5.7 1 1.5 2.1 2.6 2.1 1 0 1.4-.7 2.7-.7 1.2 0 1.6.7 2.7.7 1.1 0 1.8-1 2.5-2 .8-1.2 1.1-2.3 1.1-2.4-.1 0-2-.8-2-3.5ZM14.7 7.2c.6-.8 1-1.8.9-2.9-1 .1-2.1.7-2.8 1.5-.6.7-1.1 1.8-.9 2.8 1.1.1 2.1-.5 2.8-1.4Z"/>
    </svg>
  `,
  youtubemusic: `
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path d="M12 3.5a8.5 8.5 0 1 0 0 17 8.5 8.5 0 0 0 0-17Zm0 2a6.5 6.5 0 1 1 0 13 6.5 6.5 0 0 1 0-13Zm-1.2 3.1v6.8l6-3.4-6-3.4Z"/>
    </svg>
  `,
  bandcamp: `
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path d="M4 17.5 9.8 6.5H20l-5.8 11H4Z"/>
    </svg>
  `,
  soundcloud: `
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path d="M6.5 12.5a1 1 0 0 0-2 0v5a1 1 0 0 0 2 0v-5Zm2-.7a1 1 0 0 0-2 0v5.7a1 1 0 0 0 2 0v-5.7Zm2-.6a1 1 0 0 0-2 0v6.3a1 1 0 0 0 2 0v-6.3ZM20 14.2a3.4 3.4 0 0 0-3.3-3.4c-.3 0-.6 0-.8.1A4.6 4.6 0 0 0 11.5 7c-.3 0-.6 0-.9.1v10.3H20a2.8 2.8 0 0 0 0-3.2Z"/>
    </svg>
  `
};

function setDetails(section){
  detailTitle.textContent = section.title;
  detailSubtitle.textContent = section.subtitle;

  // Keep tip jar visible everywhere (move the same DOM node around)
  const tip = document.getElementById('tipJarWrap');

  // Clear first (IMPORTANT)
  detailContent.innerHTML = '';

  // =========================
  // MUSIC
  // =========================
  if (section.id === "music") {

    // 1) Streaming Sites heading + buttons
    if (Array.isArray(section.links) && section.links.length) {
      const h1 = document.createElement('div');
      h1.className = 'panel-head';
      h1.textContent = 'Stream Our Music Here';
      detailContent.appendChild(h1);

      const linkRow = document.createElement('div');
      linkRow.className = 'streaming-links';

      section.links.forEach(link => {
        const a = document.createElement('a');
        a.className = 'stream-btn';
        a.href = link.url;
        a.target = "_blank";
        a.rel = "noopener";
        a.dataset.platform = link.platform || '';

        const icon =
          (typeof PLATFORM_ICONS !== "undefined" && PLATFORM_ICONS[link.platform])
            ? PLATFORM_ICONS[link.platform]
            : '';

        a.innerHTML = `
          <span class="stream-ico">${icon}</span>
          <span class="stream-label">${link.name}</span>
        `;
        linkRow.appendChild(a);
      });

      detailContent.appendChild(linkRow);

      // 2) Spotify Playlist heading
      const h2 = document.createElement('div');
      h2.className = 'panel-head panel-head-playlist';
      h2.textContent = 'Spotify Playlist';
      detailContent.appendChild(h2);
    }

    // 3) Spotify embed (cached so it doesn't reload)
    if (section.embed) {
      if (!musicEmbedCache) {
        const embedWrap = document.createElement('div');
        embedWrap.className = 'embed-wrap';
        embedWrap.innerHTML = section.embed;
        musicEmbedCache = embedWrap;

        // First-click guard (only once) so tapping Spotify can disable hover audio
        const guard = document.createElement('div');
        guard.className = 'iframe-guard';
        guard.setAttribute('aria-label', 'Enable Spotify playback');
        guard.title = 'Tap to play Spotify (disables hover audio)';

        guard.addEventListener('pointerdown', () => {
          if (typeof disableHoverAudioForExternalPlayer === "function") {
            disableHoverAudioForExternalPlayer();
          }
          guard.remove();
        }, { passive: true });

        embedWrap.appendChild(guard);
      }

      detailContent.appendChild(musicEmbedCache);
    }

    // 4) Downloads (below player)
    if (Array.isArray(section.downloads) && section.downloads.length) {
      const h3 = document.createElement('div');
      h3.className = 'panel-head panel-head-downloads';
      h3.textContent = 'Free Song Downloads';
      detailContent.appendChild(h3);

      const list = document.createElement('div');
      list.className = 'download-list';

      section.downloads.forEach(track => {
        const row = document.createElement('div');
        row.className = 'download-item';

        const meta = track.meta
          ? `<div class="dl-meta">${track.meta}</div>`
          : `<div class="dl-meta">MP3</div>`;

        const trackedUrl = track.url;

        row.innerHTML = `
          <div class="dl-left">
            <div class="dl-title">${track.title}</div>
            ${meta}
          </div>

          <a class="dl-btn"
             href="${trackedUrl}"
             target="_blank"
             rel="noopener"
             download>
            <span class="dl-ico">${typeof DL_ICON !== "undefined" ? DL_ICON : ""}</span>
            Download
          </a>
        `;

        list.appendChild(row);
      });

      detailContent.appendChild(list);
    }
  }

  // =========================
  // EMBED (for non-music sections like Videos, etc.)
  // =========================
  else if (section.embed) {
    const embedWrap = document.createElement('div');
    embedWrap.className = 'embed-wrap';
    embedWrap.innerHTML = section.embed;
    detailContent.appendChild(embedWrap);
  }

  // =========================
  // SOCIAL
  // =========================
  else if (section.id === "social") {
    const h = document.createElement('div');
    h.className = 'panel-head';
    h.textContent = 'Follow Us';
    detailContent.appendChild(h);

    const linkRow = document.createElement('div');
    linkRow.className = 'streaming-links';

    (section.links || []).forEach(link => {
      const a = document.createElement('a');
      a.className = 'stream-btn';
      a.href = link.url;
      a.target = "_blank";
      a.rel = "noopener";
      a.dataset.platform = link.platform || '';

      a.innerHTML = `<span class="stream-label">${link.name}</span>`;
      linkRow.appendChild(a);
    });

    detailContent.appendChild(linkRow);
  }

  // =========================
  // MERCH
  // =========================
  else if (section.id === "merch") {

    // Top: Visit Store button
    if (section.shopUrl) {
      const topRow = document.createElement('div');
      topRow.className = 'cta-row';
      topRow.style.marginTop = '0';
      topRow.style.justifyContent = 'center';

      const topBtn = document.createElement('a');
      topBtn.className = 'btn';
      topBtn.href = section.shopUrl;
      topBtn.target = "_blank";
      topBtn.rel = "noopener";
      topBtn.textContent = 'Visit Store';

      topRow.appendChild(topBtn);
      detailContent.appendChild(topRow);
    }

    // Heading
    const h = document.createElement('div');
    h.className = 'panel-head';
    h.textContent = 'Featured Merch';
    detailContent.appendChild(h);

    // Grid
    const grid = document.createElement('div');
    grid.className = 'merch-grid';

    (section.products || []).forEach(p => {
      const a = document.createElement('a');
      a.className = 'merch-card';
      a.href = p.url;
      a.target = "_blank";
      a.rel = "noopener";

      a.innerHTML = `
        <img class="merch-img" src="${p.img}" alt="${p.title}" loading="lazy">
        <div class="merch-title">${p.title}</div>
      `;

      grid.appendChild(a);
    });

    detailContent.appendChild(grid);
  }

  // =========================
  // NEWS
  // =========================
  else if (section.id === "news") {
    const h = document.createElement('div');
    h.className = 'panel-head';
    h.textContent = 'Latest News';
    detailContent.appendChild(h);

    if (Array.isArray(section.posts) && section.posts.length) {
      const wrap = document.createElement('div');
      wrap.className = 'news-list';

      section.posts.forEach(p => {
        const card = document.createElement('div');
        card.className = 'news-item';
        card.innerHTML = `
          <div class="news-date">${p.date || ''}</div>
          <div class="news-title">${p.title || ''}</div>
          <div class="news-text">${p.text || ''}</div>
        `;
        wrap.appendChild(card);
      });

      detailContent.appendChild(wrap);
    } else {
      const empty = document.createElement('p');
      empty.style.margin = '10px 0 0';
      empty.style.opacity = '.85';
      empty.textContent = 'No updates yet — check back soon.';
      detailContent.appendChild(empty);
    }
  }

  // =========================
  // RELEASES
  // =========================
  else if (section.id === "releases") {
    const h = document.createElement('div');
    h.className = 'panel-head';
    h.textContent = 'Releases';
    detailContent.appendChild(h);

    if (Array.isArray(section.releases) && section.releases.length) {
      const wrap = document.createElement('div');
      wrap.className = 'release-list';

      section.releases.forEach(r => {
        const card = document.createElement('div');
        card.className = 'release-item';

        const coverSrc = r.cover
  ? (r.cover.startsWith('http') ? r.cover : '/' + r.cover.replace(/^\.?\//, ''))
  : '';

const coverHtml = coverSrc
  ? `<img class="release-cover"
          src="${encodeURI(coverSrc)}"
          alt="${r.title} cover"
          loading="lazy"
          onerror="this.style.display='none'; console.warn('Missing cover:', '${coverSrc}')">`
  : `<div class="release-cover placeholder" aria-hidden="true"></div>`;

        const linksHtml = (Array.isArray(r.links) && r.links.length)
          ? `
            <div class="release-links">
              ${r.links.map(link => {
                const icon =
                  (typeof PLATFORM_ICONS !== "undefined" && PLATFORM_ICONS[link.platform])
                    ? PLATFORM_ICONS[link.platform]
                    : '';
                return `
                  <a class="stream-btn" href="${link.url}" target="_blank" rel="noopener" data-platform="${link.platform || ''}">
                    <span class="stream-ico">${icon}</span>
                    <span class="stream-label">${link.name}</span>
                  </a>
                `;
              }).join('')}
            </div>
          `
          : '';

        card.innerHTML = `
          <div class="release-top">
            ${coverHtml}
            <div class="release-meta">
              <div class="release-date">${r.date || ''}</div>
              <div class="release-title">${r.title || ''}</div>
              <div class="release-type">${r.type || ''}</div>
              ${r.blurb ? `<div class="release-blurb">${r.blurb}</div>` : ''}
            </div>
          </div>
          ${linksHtml}
        `;

        wrap.appendChild(card);
      });

      detailContent.appendChild(wrap);
    } else {
      const empty = document.createElement('div');
      empty.style.marginTop = '10px';
      empty.style.opacity = '.85';
      empty.textContent = 'No releases listed yet.';
      detailContent.appendChild(empty);
    }
  }

  // =========================
  // TIP JAR (always at bottom)
  // =========================
  if (tip) detailContent.appendChild(tip);

  // If you still want the top-right button in the card:
  // primaryCta.textContent = section.ctaText || 'Start Here';
  // primaryCta.href = section.ctaHref || '#';
}

    function setNowPlaying(section){
      nowPlaying.textContent = `Now playing: ${section.title} preview`;
    }
	
	function disableHoverAudioForExternalPlayer(){
  fadeToken++;
  stopAll();            // stops preview audio + clears activeAudioId
  audioEnabled = false; // disables hover-trigger audio
  nowPlaying.textContent = 'Spotify active (hover audio disabled)';
  updateStopButton();
}

function unlockAudio() {
  armAudioOnce();
  window.removeEventListener('pointerdown', unlockAudio);
  window.removeEventListener('keydown', unlockAudio);
  window.removeEventListener('touchstart', unlockAudio);
}

window.addEventListener('pointerdown', unlockAudio);
window.addEventListener('keydown', unlockAudio);
window.addEventListener('touchstart', unlockAudio);

function updateStopButton(){
  const stopBtn = document.getElementById('stopAudio');
  const label = document.getElementById('stopLabel');
  if(!stopBtn || !label) return;

  // State logic:
  // - If audioEnabled is false -> show "Enable Audio" (and NOT live)
  // - Else if activeAudioId exists -> show "Stop" + live pulsing
  // - Else -> show "Stopped"
  const isLive = audioEnabled && !!activeAudioId;

  let nextText = 'Stopped';
  if(!audioEnabled) nextText = 'Enable Audio';
  else if(activeAudioId) nextText = 'Stop';

  stopBtn.classList.toggle('live', isLive);

  // treat as disabled only when: audio enabled but nothing playing
  // (Enable Audio should still be clickable)
  const ariaDisabled = 'false'; // always clickable: Stop or Enable Audio
  stopBtn.setAttribute('aria-disabled', ariaDisabled);

  if(label.textContent === nextText) return;

  label.classList.add('fading');
  setTimeout(() => {
    label.textContent = nextText;
    label.classList.remove('fading');
  }, 90);
}


async function activate(section){
  // Always do visuals + UI updates
  setCursorSrc(section.cursorSrc || 'assets/cursor-magpie.png');
  setCursorBig(true);

  cursorPeck();
  spawnSparkles(cursorX, cursorY);

  setDetails(section);

  // ✅ Mobile: never preview audio
  if (MOBILE) {
    return;
  }

  // Desktop: if user disabled audio, show message + stop
  if (!audioEnabled){
    nowPlaying.textContent = 'Audio disabled (click Enable Audio)';
    return;
  }

  // Audio is enabled → proceed normally
  setNowPlaying(section);

  if(!audioArmed){
    const ok = await armAudioOnce();
    if(!ok){
      nowPlaying.textContent = 'Click once to enable audio';
      return;
    }
  }

  crossfade(section.id);
}


// Render tiles into the top row under the header

SECTIONS.forEach(section => {
  const btn = document.createElement('button');
  btn.className = 'orbit-tile';
  btn.type = 'button';
  btn.setAttribute('aria-label', section.title);

  btn.innerHTML = `
    <div class="tile-img-wrap">
      <img class="tile-img" src="${section.shinyBg}" alt="">
    </div>
    <p class="title">${section.title}</p>
    <div class="kicker">${section.kicker}</div>
  `;

// Desktop/laptop devices that can hover get hover previews
if (CAN_HOVER) {
  btn.addEventListener('mouseenter', () => activate(section));
}

btn.addEventListener('click', () => {
  activate(section);
  if (MOBILE || SMALL) scrollToDetails();
});

  tilesEl.appendChild(btn);
});

// Cursor shrink when leaving the top links row
tilesEl.addEventListener('mouseleave', () => {
  setCursorBig(false);
  setCursorSrc('assets/cursor-magpie.png');
});


// Top CTA placeholders
document.getElementById('joinMailing').addEventListener('click', (e)=>{
  e.preventDefault();

  // Find the Militia section config
  const militiaSection = SECTIONS.find(s => s.id === 'militia');
  if(!militiaSection) return;

  // Activate it (same behavior as clicking the tile)
  activate(militiaSection);

  // Scroll to the center stage detail panel
  const centerStage = document.querySelector('.center-stage');
  if(centerStage){
    centerStage.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }
});
document.getElementById('bookUs').addEventListener('click', (e)=>{
  e.preventDefault();
  alert('Hook this up to your booking email or form.');
});
document.getElementById('stopAudio').addEventListener('click', async (e) => {
  e.preventDefault();
  e.stopPropagation();

  // If currently disabled, this button acts as "Enable Audio"
  if(!audioEnabled){
    audioEnabled = true;

    // this click counts as a gesture, so we can arm
    if (!MOBILE && audioEnabled && !audioArmed) await armAudioOnce();

    nowPlaying.textContent = 'Hover a section to play a preview';
    updateStopButton();
    return;
  }

  // If enabled but nothing is playing, still allow disabling audio
  // (so it becomes "Enable Audio" again)
  fadeToken++;
  stopAll();           // stops + clears activeAudioId
  audioEnabled = false;

  nowPlaying.textContent = 'Audio disabled (click Enable Audio)';
  setCursorBig(false);
  setCursorSrc('assets/cursor-magpie.png');

  updateStopButton();
});

// Footer year
document.getElementById('year').textContent = new Date().getFullYear();

// Autoplay policy hint: first user interaction can unlock audio on iOS/Safari
window.addEventListener('pointerdown', async () => {
  if (!MOBILE && audioEnabled && !audioArmed) await armAudioOnce();
  updateStopButton();
}, { once:true });
updateStopButton();

  </script>
</body>
</html>
